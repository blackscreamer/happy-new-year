<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal-Terminal-Script</title>
    <style>
        /*
         * -----------------
         * GLOBAL STYLES (Includes CSS Variables)
         * -----------------
         */
        :root {
            --color-background-primary: #1e1e1e;
            --color-terminal-bg: #0c0c0c;
            --color-text-default: #d4d4d4;
            --color-titlebar: #cccccc;
            --color-syntax-keyword: #569cd6;
            --color-syntax-string: #ce9178;
            --color-syntax-comment: #6a9955;
            --color-syntax-function: #dcdcaa;
        }

        body {
            background: var(--color-background-primary);
            font-family: Consolas, "Courier New", monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: var(--color-text-default);
            overflow: hidden;
        }

        /*
         * -----------------
         * TERMINAL STYLES
         * -----------------
         */
        .terminal {
            background: var(--color-terminal-bg);
            border-radius: 8px;
            width: 90%;
            max-width: 760px;
            padding: 20px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
            max-height: 90vh; 
            display: flex;
            flex-direction: column;
        }

        .titlebar {
            color: var(--color-titlebar);
            margin-bottom: 12px;
            font-size: 14px;
            user-select: none;
        }

        #output {
            overflow-y: auto; 
            flex-grow: 1;
            padding-right: 5px;
        }

        .line {
            white-space: pre-wrap; 
            margin-bottom: 6px; 
            line-height: 1.4;
        }
        
        /*
         * -----------------
         * TYPING & CURSOR
         * -----------------
         */
        .cursor::after {
            content: '‚ñà';
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /*
         * -----------------
         * SYNTAX COLORS
         * -----------------
         */
        .keyword { color: var(--color-syntax-keyword); }
        .string { color: var(--color-syntax-string); }
        .comment { color: var(--color-syntax-comment); }
        .function { color: var(--color-syntax-function); }

        /*
         * -----------------
         * BUTTONS & CONTROLS
         * -----------------
         */
        .buttons {
            margin-top: 20px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            min-height: 36px;
        }

        button {
            font-family: inherit;
            background: transparent;
            border: 1px solid var(--color-text-default);
            color: var(--color-text-default);
            padding: 8px 16px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s ease-in-out;
            font-size: 1em;
        }

        button:hover:not(:disabled) { 
            background: var(--color-text-default);
            color: var(--color-terminal-bg);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }

        button:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        /* Disabled Button Style (for spam prevention) */
        button:disabled {
            opacity: 0.5; 
            cursor: default; 
            pointer-events: none;
        }
        
        /* Removed all Firework CSS styles */
    </style>
</head>
<body>
    <div class="terminal">
        <div class="titlebar">hello hello pillow expert</div>
        <div id="output"></div> 
        <div class="buttons" id="controls"></div>
    </div>

    <script>
        (function() {
            const output = document.getElementById('output');
            const controls = document.getElementById('controls');

            // Timing variables
            const TYPE_SPEED_MS = 65; // Slower Typing Speed
            const LINE_DELAY_MS = 250; 
            // Removed POPPER_DURATION_MS

            let queue = [];
            let isTyping = false; 

            // --- Control and State Management ---

            /** Enables or disables all buttons (Spam Prevention) */
            function setControlsState(enabled) {
                controls.querySelectorAll('button').forEach(btn => {
                    btn.disabled = !enabled;
                });
            }

            function clearButtons() { 
                controls.innerHTML = ''; 
            }
            
            function addButton(label, action) { 
                const btn = document.createElement('button'); 
                btn.textContent = label; 
                btn.addEventListener('click', action); 
                controls.appendChild(btn); 
                // Ensure new buttons respect the current typing state
                btn.disabled = isTyping; 
            }
            
            // --- Typing Queue Logic ---

            function enqueue(text, isHTML = false) {
                queue.push({ text, isHTML });
                if (!isTyping) processQueue();
            }

            function processQueue() {
                if (queue.length === 0) {
                    isTyping = false;
                    setControlsState(true); // Enable buttons when idle
                    return;
                }

                isTyping = true;
                setControlsState(false); // Disable buttons while typing

                const { text, isHTML } = queue.shift();
                const div = document.createElement('div');
                div.className = 'line cursor';
                output.appendChild(div);
                
                output.scrollTop = output.scrollHeight;

                let i = 0;
                
                const plainText = isHTML ? (() => { 
                    const t = document.createElement('div'); 
                    t.innerHTML = text; 
                    return t.textContent; 
                })() : text;

                function type() {
                    if (i < plainText.length) { 
                        div.textContent += plainText.charAt(i++); 
                        setTimeout(type, TYPE_SPEED_MS); 
                    } else { 
                        div.classList.remove('cursor');
                        if (isHTML) {
                            div.innerHTML = text;
                        }
                        output.scrollTop = output.scrollHeight;
                        setTimeout(processQueue, LINE_DELAY_MS); 
                    }
                }
                
                type();
            }
           

            // --- Scene Functions ---

            function start() {
                clearButtons();
                enqueue('TEST TEST TEST\n1 2 1 2\nwell I guess it\'s working all fine ( hmmm i guess )');
                enqueue('Hey Mina, I built this specifically for you... hope you\'re ready.');
                addButton('Start', happyNewYear);
            }

            function happyNewYear() {
                clearButtons();
                
                enqueue('Mina, I\'ll keep this short to spare you my yapping! I like you, and I‚Äôve reached a point where I can\'t hide how much you mean to me.');
                enqueue('I\'d say you‚Äôve become the foundation of my days. You are perfect to me; everything about our connection feels so special and natural.');
                enqueue('Even with no obligation at all, I genuinely want to share my days with you and hear everything about yours.');
                enqueue('On this day, I think it‚Äôs the perfect occasion for us to start the new year together. Let‚Äôs write the code for "us" ‚Äî line by line, laughing when it‚Äôs green, and sticking together as one when it‚Äôs all red, debugging our way through until it\'s green again.');
                enqueue('I‚Äôll make the initiative of starting the first lines myself...');

                addButton('Start the code', startCoding);
            }

            function startCoding() {
                clearButtons();
                const code = [
                    '<span class="keyword">const</span> me el mi3mari = <span class="string">"Ready"</span>;',
                    '<span class="keyword">let</span> you pillow expert = <span class="string">"?"</span>; <span class="comment">// waiting for your input‚Ä¶</span>',
                    '', 
                    '<span class="keyword">if</span> (you === <span class="string">"Ready"</span>) {',
                    ' ¬†git.<span class="function">checkout</span>(<span class="string">"us-branch"</span>);',
                    ' ¬†git.<span class="function">merge</span>(me, you);',
                    ' ¬†git.<span class="function">commit</span>(<span class="string">"Initial commit: Us v1.0 üöÄ"</span>);',
                    '} <span class="keyword">else</span> {',
                    ' ¬†<span class="comment">// no pressure, I‚Äôm not going anywhere</span>',
                    ' ¬†<span class="function">keepTalking</span>();',
                    '}'
                ];
                code.forEach(line => enqueue(line, true));
                
                addButton('I AM IN', iamIn);
                addButton('Sorry!', sorry);
            }

            function iamIn() {
                clearButtons();
                
                // Final message is just enqueued without animation
                enqueue('> git commit successful ‚ù§Ô∏è\nstatus: happily deployed', true);

                // Buttons added directly without animation delay
                addButton('Send answer to the dev', sendAnswer);
            }

            function sorry() {
                clearButtons();
                enqueue('No worries. keepTalking()'); 
                addButton('Send answer to the dev', sendAnswer);
            }

            function sendAnswer() {
                clearButtons();
                enqueue('Oops, there is an error with the network. Please submit your answer to the dev manually in the DMs.');
            }


            // --- Initialization ---
            
            addButton('Start', start);

        })(); 
    </script>
</body>
</html>
